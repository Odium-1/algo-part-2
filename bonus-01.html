<!doctype html>
<html lang="fr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport"
        content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible">
    <title>Exo bonus#01 - Email ?</title>
    <link href="./bootstrap.min.css" rel="stylesheet" />
    <link href="./style.css" rel="stylesheet" />
</head>

<body>
    <div class="card">
        <p class="h6 font-weight-bold text-center">Bonus#01 - Vous avez dit email ?</p>
        <div class="instructions">
            <p class="text-secondary">Votre mission si toutefois vous l'acceptez, est de vérifier que le champ saisi
                correspond bien à une adresse électronique</p>
            <br />
            <p class="text-secondary">On considère un email comme valide si il est de la forme :
            <pre>firstname.lastname@domain.ext</pre> avec :
            <ul class="text-secondary">
                <li><em>firstname</em> possiblement vide ; dans ce cas, le point séparant firstname de lastname ne doit
                    pas exister>.</li>
                <li><em>lastname</em> doit contenir au moins 3 caractères.</li>
                <li><em>domain</em> doit contenir au moins 6 caractères et précédé de @.</li>
                <li><em>ext</em> (extension) doit contenir de 2 à 4 caractères.</li>
            </ul>
            </p>
            <br />
            <p class="text-success">L'étude de l'objet JavaScript <a
                    href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String"
                    target="_blank">String</a>
                et de ses méthodes, plus particulièrement la méthode <em>split(...)</em>
                (voire la méthode <em>match(...)</em> pour les plus téméraires) sera utile !
            </p>
        </div>

        <br />
        <label for="mail">Adresse électronique</label>
        <input type="text" id="mail" name="mail" placeholder="Votre adresse électronique">

        <button type="button" class="btn btn-primary" onclick="checkEmail()">
            Tester l'adresse électronique
        </button>

    </div>

    <script type="text/javascript">

        function checkEmail() {
            //const firstName = /(?<!@)w*(?=.)/
            const email = document.getElementById("mail").value || undefined;
            if (email == undefined) {
                alert("Veuillez entrer votre adresse électronique.");
            }

            const arobaz = email.split(/@/); // tester si array.length = 2 et si array[1] = + de 6 charactères 
            
            const domain = arobaz[1].split(/\./); // tester si array.length = 2 et si ext = 2 à 4 charactères
            const name = arobaz[0].split(/\./); // tester si array.length = 2, si 1 pas de "." + tester si lastname >= 3 charactères

            if (arobaz.length == 2 && arobaz[1].length >= 6 && domain.length == 2 && domain[1].length >= 2 && domain[1].length <= 4
                && (name.length == 1 && name[0].length >= 3 || name.length == 2 && name[0] != "" && name[1].length >= 3)) {
                alert("Votre adresse e-mail est valide !");
            } else {
                alert("Le format de votre adresse e-mail n'est pas valide !");
            }

            // ^ Problème avec cette solution : Si il n'y a pas d'@, la constante arobaz est indéfinie et la fonction se casse

            // if (arobaz.length == 2) && arobaz[1].length >= 6{
            //     if (isDomainValid()) {
            //         if (isNameValid())
            // }
            // } else {
            //     alert("Le format de votre adresse électronique n'est pas valide.")
            // }

        }
    </script>
</body>

</html>